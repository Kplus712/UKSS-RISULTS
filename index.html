<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>UKSS Login â€” Smart School System</title>
<meta name="viewport" content="width=device-width,initial-scale=1">

<!-- ===== STYLE ===== -->
<style>
html,body{
  margin:0;
  height:100%;
  background:#020617;
  overflow:hidden;
  font-family:system-ui,Segoe UI,Roboto;
}

/* SCENE */
.scene{
  position:relative;
  width:100%;
  height:100%;
  perspective:1200px;
}

/* GROUND */
.ground{
  position:absolute;
  bottom:0;
  width:100%;
  height:35%;
  background:linear-gradient(#14532d,#052e16);
}

/* CHARACTER */
.character{
  position:absolute;
  bottom:35%;
  left:-200px;
  width:160px;
  height:320px;
  transform-style:preserve-3d;
}

/* BODY */
.body{
  width:100px;
  height:120px;
  background:#16a34a;
  border-radius:20px;
  position:absolute;
  left:30px;
  top:80px;
}
.head{
  width:70px;
  height:70px;
  background:#ffd6c9;
  border-radius:50%;
  position:absolute;
  left:45px;
  top:0;
}
.eye{
  width:8px;height:8px;background:#000;border-radius:50%;
  position:absolute;top:25px;
}
.eye.left{left:15px}
.eye.right{right:15px}
.mouth{
  width:20px;height:10px;background:#ef4444;
  position:absolute;bottom:15px;left:50%;
  transform:translateX(-50%);
  border-radius:0 0 10px 10px;
}

/* LIMBS */
.arm,.leg{
  position:absolute;background:#16a34a;border-radius:10px;
  transform-origin:top center;
}
.arm{width:16px;height:80px;top:90px;}
.arm.left{left:15px}
.arm.right{right:15px}
.leg{width:20px;height:90px;bottom:0;}
.leg.left{left:40px}
.leg.right{right:40px}

/* BAG */
.bag{
  width:45px;height:60px;
  background:#92400e;
  position:absolute;
  left:-40px;top:110px;
  border-radius:8px;
}

/* LOGIN CARD */
.login-card{
  position:absolute;
  right:10%;
  top:50%;
  transform:translateY(-50%) scale(0.9);
  width:360px;
  background:rgba(255,255,255,0.95);
  padding:26px;
  border-radius:18px;
  opacity:0;
  box-shadow:0 30px 80px rgba(0,0,0,.4);
}
.login-card h2{text-align:center;margin:0 0 10px}
.input{
  width:100%;padding:12px;border-radius:10px;
  border:1px solid #ccc;margin-bottom:12px;
}
.btn{
  width:100%;padding:12px;
  background:linear-gradient(90deg,#22c55e,#16a34a);
  border:none;border-radius:20px;
  font-weight:bold;cursor:pointer;
}
.status{margin-top:10px;font-size:13px;text-align:center}
</style>
</head>

<body>
<div class="scene">

  <div class="ground"></div>

  <!-- CHARACTER -->
  <div class="character" id="char">
    <div class="head">
      <div class="eye left"></div>
      <div class="eye right"></div>
      <div class="mouth"></div>
    </div>
    <div class="body"></div>
    <div class="arm left"></div>
    <div class="arm right"></div>
    <div class="leg left"></div>
    <div class="leg right"></div>
    <div class="bag"></div>
  </div>

  <!-- LOGIN -->
  <div class="login-card" id="loginCard">
    <h2>UKSS Login</h2>
    <input id="email" class="input" type="email" placeholder="Email">
    <input id="password" class="input" type="password" placeholder="Password">
    <button class="btn" id="loginBtn">LOGIN</button>
    <div class="status" id="status"></div>
  </div>

</div>

<!-- ===== FIREBASE ===== -->
<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-auth.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-firestore.js"></script>

<script src="js/database.js"></script>

<!-- ===== SOUNDS ===== -->
<script>
const sounds={
 step:new Audio("assets/sounds/step.mp3"),
 bag:new Audio("assets/sounds/bag-drop.mp3"),
 typing:new Audio("assets/sounds/typing.mp3"),
 success:new Audio("assets/sounds/success.mp3"),
 error:new Audio("assets/sounds/error.mp3")
};
function s(n){sounds[n]&& (sounds[n].currentTime=0,sounds[n].play());}
</script>

<!-- ===== MAIN LOGIC ===== -->
<script>
const char=document.getElementById("char");
const card=document.getElementById("loginCard");
const status=document.getElementById("status");

/* WALK IN */
let x=-200;
const walk=setInterval(()=>{
  x+=4;
  char.style.left=x+"px";
  char.querySelector(".arm.left").style.transform=`rotate(${Math.sin(x/10)*20}deg)`;
  char.querySelector(".arm.right").style.transform=`rotate(${Math.cos(x/10)*20}deg)`;
  s("step");
  if(x>window.innerWidth*0.45){
    clearInterval(walk);
    s("bag");
    document.querySelector(".bag").style.top="200px";
    card.style.opacity=1;
    card.style.transform="translateY(-50%) scale(1)";
  }
},30);

/* LOGIN */
document.getElementById("loginBtn").onclick=async()=>{
  const email=email.value.trim();
  const pass=password.value;
  status.textContent="Authenticating...";
  s("typing");

  try{
    const cred=await auth.signInWithEmailAndPassword(email,pass);
    const uid=cred.user.uid;

    const snap=await db.collection("staff").doc(uid).get();
    const role=snap.exists?snap.data().role:"academic";

    s("success");
    status.textContent="Welcome "+role;

    setTimeout(()=>{
      if(role==="admin")location="admin.html";
      else if(role==="headmaster")location="results.html";
      else if(role==="classteacher")location="marks.html";
      else location="marks.html";
    },1200);

  }catch(e){
    s("error");
    status.textContent=e.message;
  }
};
</script>
</body>
</html>
