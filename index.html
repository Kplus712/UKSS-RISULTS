<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>UKSS Results System â€” Login</title>

<style>
:root{
  --green:#22c55e;
  --dark:#041b12;
}
*{box-sizing:border-box}
body{
  margin:0;
  min-height:100vh;
  display:flex;
  align-items:center;
  justify-content:center;
  background:radial-gradient(circle at top,#0a3a2a,#02140d);
  font-family:system-ui,Segoe UI,Roboto;
  color:#eafff3;
  overflow:hidden;
}

/* 3D STAGE */
.stage{
  perspective:1200px;
  display:flex;
  gap:80px;
  align-items:center;
}

/* CHARACTER (SOFT 3D PLACEHOLDER) */
.character{
  width:160px;
  height:260px;
  background:linear-gradient(180deg,#34d399,#059669);
  border-radius:80px 80px 40px 40px;
  box-shadow:0 30px 60px rgba(0,0,0,.5);
  transform-style:preserve-3d;
  transition:.3s ease;
}

/* LOGIN CARD */
.card{
  width:380px;
  padding:28px;
  border-radius:22px;
  background:linear-gradient(180deg,#0b3f2b,#06271c);
  box-shadow:0 40px 80px rgba(0,0,0,.7);
  border:1px solid rgba(255,255,255,.05);
  transform-style:preserve-3d;
  transition:.25s ease;
}

h1{margin:0;font-size:22px}
.sub{opacity:.8;font-size:13px;margin-bottom:18px}

label{font-size:13px}
input{
  width:100%;
  padding:12px;
  margin-top:6px;
  border-radius:12px;
  border:1px solid rgba(255,255,255,.08);
  background:#03140e;
  color:#eafff3;
}
button{
  width:100%;
  margin-top:16px;
  padding:13px;
  border-radius:30px;
  border:0;
  background:linear-gradient(90deg,#22c55e,#16a34a);
  font-weight:700;
  cursor:pointer;
}

.msg{
  margin-top:10px;
  font-size:13px;
  min-height:18px;
}
.msg.error{color:#ffb4b4}
.msg.success{color:#a7f3d0}

.footer{
  margin-top:14px;
  font-size:12px;
  opacity:.7;
  text-align:center;
}
</style>
</head>

<body>

<div class="stage">
  <div class="character" id="character"></div>

  <form class="card" id="loginForm">
    <h1>UKSS Results System</h1>
    <div class="sub">UMOJA KINGORI SECONDARY â€” Staff Login</div>

    <label>Email</label>
    <input id="email" type="email" required placeholder="you@school.ac.tz">

    <label style="margin-top:12px">Password</label>
    <input id="password" type="password" required placeholder="********">

    <button type="submit">Login</button>

    <div id="msg" class="msg"></div>

    <div class="footer">
      Accounts husimamiwa na Admin / Academic / Headmaster
    </div>
  </form>
</div>

<!-- FIREBASE v8 -->
<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-auth.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-firestore.js"></script>

<script>
/* ================= FIREBASE INIT ================= */
firebase.initializeApp({
  apiKey: "YOUR_KEY",
  authDomain: "YOUR_PROJECT.firebaseapp.com",
  projectId: "YOUR_PROJECT"
});
const auth = firebase.auth();
const db   = firebase.firestore();

/* ================= 3D PARALLAX ================= */
const card = document.querySelector(".card");
const chara = document.getElementById("character");

document.addEventListener("mousemove",e=>{
  const x=(e.clientX/window.innerWidth-.5)*20;
  const y=(e.clientY/window.innerHeight-.5)*20;
  card.style.transform=`rotateY(${x}deg) rotateX(${-y}deg)`;
  chara.style.transform=`translateX(${x}px) rotateY(${x}deg)`;
});
document.addEventListener("mouseleave",()=>{
  card.style.transform="rotateX(0) rotateY(0)";
  chara.style.transform="rotateY(0)";
});

/* ================= LOGIN LOGIC ================= */
const form=document.getElementById("loginForm");
const msg=document.getElementById("msg");

form.addEventListener("submit",async e=>{
  e.preventDefault();
  msg.textContent="Inaingia...";
  msg.className="msg";

  const email=document.getElementById("email").value;
  const pass=document.getElementById("password").value;

  try{
    const cred=await auth.signInWithEmailAndPassword(email,pass);
    const snap=await db.collection("staff").doc(cred.user.uid).get();

    if(!snap.exists) throw new Error("NO_ROLE");

    const role=snap.data().role;

    msg.textContent="Karibu ðŸŽ‰";
    msg.className="msg success";

    setTimeout(()=>{
      if(role==="admin") location.href="admin.html";
      else if(role==="academic") location.href="marks.html";
      else if(role==="headmaster") location.href="results.html";
      else location.href="marks.html";
    },900);

  }catch(err){
    msg.className="msg error";
    if(err.message==="NO_ROLE"){
      msg.textContent="Account haina role. Wasiliana na Admin.";
    }else{
      msg.textContent="Email au password sio sahihi.";
    }
  }
});
</script>

</body>
</html>

