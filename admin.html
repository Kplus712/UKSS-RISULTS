<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>UKSS â€” Admin</title>
  <link rel="stylesheet" href="./style.css" />
</head>
<body>

<div class="app">
  <!-- SIDEBAR -->
  <aside class="sidebar">
    <div class="brand">
      <div class="brand-badge">UK</div>
      <div>
        <div class="brand-title">UKSS</div>
        <div class="brand-sub">Results Management</div>
      </div>
    </div>

    <nav class="nav">
      <a href="marks.html">ğŸ  Marks</a>
      <a href="results.html">ğŸ“„ Results</a>
      <a href="ranking.html">ğŸ† Ranking</a>
      <a href="behaviour.html">ğŸ§­ Behaviour</a>
      <a href="sms.html">ğŸ“¨ SMS</a>
      <a href="sms_logs.html">ğŸ§¾ SMS Logs</a>
      <a href="admin.html" class="active">ğŸ” Admin</a>
    </nav>
  </aside>

  <!-- MAIN -->
  <main class="main">

    <!-- TOPBAR -->
    <header class="topbar">
      <div>
        <h2>ğŸ” Admin Control Center</h2>
        <p class="small">
          Full control kwa system owner: staff roles, system settings, logs na approvals za access.
        </p>
      </div>
      <button id="logoutBtn" class="btn btn-ghost">Logout</button>
    </header>

    <!-- YOUR ACCOUNT -->
    <section class="card">
      <h3>Your Account</h3>
      <p class="small">
        Hapa unaona taarifa zako na role uliyopewa. Kazi za admin zipo chini.
      </p>

      <div class="row row-wrap">
        <div class="field">
          <label class="label">Name</label>
          <input id="meName" class="input" type="text" disabled />
        </div>
        <div class="field">
          <label class="label">Email</label>
          <input id="meEmail" class="input" type="text" disabled />
        </div>
        <div class="field">
          <label class="label">Role</label>
          <input id="meRole" class="input" type="text" disabled />
        </div>
        <div class="field">
          <label class="label">Main Class (for class teacher)</label>
          <input id="meClass" class="input" type="text" disabled />
        </div>
      </div>

      <p id="roleWarning" class="small" style="margin-top:8px;color:#f97373;"></p>
    </section>

    <!-- 1) MANAGE STAFF (ROLES + ACTIVE) -->
    <section class="card">
      <h3>1. Staff Management</h3>
      <p class="small">
        Badili roles, class na status ya staff. â€œActiveâ€ ikizimwa, user hawezi kutumia mfumo
        (lakini account haifutwi kabisa). Kufuta kabisa tutaweka kwenye Danger Zone baadaye.
      </p>

      <div class="matrix-wrap">
        <table class="table" id="staffTable">
          <thead>
          <tr>
            <th>Name</th>
            <th>Email</th>
            <th>Role</th>
            <th>Main Class</th>
            <th>Active</th>
            <th>Updated</th>
          </tr>
          </thead>
          <tbody>
          <tr><td colspan="6">Loading staff...</td></tr>
          </tbody>
        </table>
      </div>

      <p class="small" style="margin-top:8px;">
        Roles:
        <strong>Admin</strong> (full control),
        <strong>Headmaster</strong> (approvals & reports),
        <strong>Academic</strong> (exams & analysis),
        <strong>Class Teacher</strong> (comments & class reports).
      </p>
    </section>

    <!-- 8) ACCESS CONTROL / APPROVALS -->
    <section class="card">
      <h3>2. Access Control & Approvals</h3>
      <p class="small">
        Staff wapya au wasio na role/active wataonekana hapa. Wape role sahihi na uwasha â€œActiveâ€.
        Unaweza pia ku-disable user yeyote bila kufuta kabisa account yake.
      </p>

      <div class="matrix-wrap">
        <table class="table" id="pendingTable">
          <thead>
          <tr>
            <th>Name</th>
            <th>Email</th>
            <th>Current Role</th>
            <th>New Role</th>
            <th>Set Active</th>
            <th>Apply</th>
          </tr>
          </thead>
          <tbody>
          <tr><td colspan="6">No pending staff.</td></tr>
          </tbody>
        </table>
      </div>
    </section>

    <!-- 6) SYSTEM SETTINGS -->
    <section class="card">
      <h3>3. System Settings</h3>
      <p class="small">
        Taarifa za shule na baadhi ya settings za mfumo. Zitatumika kwenye report cards,
        SMS templates na dashboards. Settings hizi zitahifadhiwa kwenye collection
        <code>settings</code>, document <code>global</code>.
      </p>

      <div class="row row-wrap">
        <div class="field">
          <label class="label">School Name</label>
          <input id="setSchoolName" class="input" placeholder="eg. Mambosasa Secondary School" />
        </div>
        <div class="field">
          <label class="label">School Motto</label>
          <input id="setSchoolMotto" class="input" placeholder="eg. Discipline and Excellence" />
        </div>
        <div class="field">
          <label class="label">School Address</label>
          <input id="setSchoolAddress" class="input" placeholder="eg. P.O. Box 123, Dar es Salaam" />
        </div>
      </div>

      <div class="row row-wrap" style="margin-top:8px;">
        <div class="field">
          <label class="label">School Phone</label>
          <input id="setSchoolPhone" class="input" placeholder="eg. 0789 000 000" />
        </div>
        <div class="field">
          <label class="label">Current SMS Provider</label>
          <input id="setSmsProvider" class="input" value="Beem Africa" />
        </div>
        <div class="field">
          <label class="label">Academic Year</label>
          <input id="setAcademicYear" class="input" placeholder="eg. 2025" />
        </div>
      </div>

      <div style="margin-top:10px;">
        <h4>Grading Scale (summary note)</h4>
        <p class="small">
          Hapa unaweka tu maelezo ya grading scale kama reference (mfano A: 75â€“100, B: 65â€“74 n.k.).
          Logic halisi ya grading tutaweka kwenye marks.js baadaye.
        </p>
        <textarea id="setGradingNote" class="textarea" rows="3"
          placeholder="eg. A: 75â€“100, B: 65â€“74, C: 45â€“64, D: 25â€“44, E: 0â€“24"></textarea>
      </div>

      <div class="row row-wrap" style="margin-top:10px;">
        <button id="saveSettingsBtn" class="btn btn-primary">Save Settings</button>
        <span id="settingsStatus" class="small"></span>
      </div>
    </section>

    <!-- 7) LOGS OVERVIEW -->
    <section class="card">
      <h3>4. Logs & Reports Overview</h3>
      <p class="small">
        Muhtasari wa rekodi muhimu. Kwa sasa unaonyesha counts na links kwenda kwenye pages husika.
      </p>

      <div class="row row-wrap">
        <div class="field">
          <label class="label">Total SMS Logs</label>
          <input id="logSmsCount" class="input" type="text" disabled value="..." />
        </div>
        <div class="field">
          <label class="label">Total Report Cards</label>
          <input id="logReportsCount" class="input" type="text" disabled value="..." />
        </div>
        <div class="field">
          <label class="label">Total Behaviour Records</label>
          <input id="logBehaviourCount" class="input" type="text" disabled value="..." />
        </div>
      </div>

      <div class="row row-wrap" style="margin-top:10px;">
        <a href="sms_logs.html" class="btn btn-ghost">Open SMS Logs Page</a>
        <a href="results.html" class="btn btn-ghost">Open Results Page</a>
        <a href="behaviour.html" class="btn btn-ghost">Open Behaviour Page</a>
      </div>
    </section>

  </main>
</div>

<!-- Firebase v8 -->
<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-auth.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-firestore.js"></script>

<!-- App scripts -->
<script src="./js/database.js"></script>
<script src="./js/admin.js"></script>
</body>
</html>
