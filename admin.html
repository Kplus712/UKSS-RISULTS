<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>UKSS â€” Admin Control Center</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
:root{
  --bg:#021b13;
  --card:#0b2f22;
  --accent:#22c55e;
  --danger:#ff6b6b;
  --text:#eafff4;
}
*{box-sizing:border-box}
body{
  margin:0;
  font-family:Segoe UI,system-ui;
  background:linear-gradient(135deg,#021b13,#053b29);
  color:var(--text);
}

/* HEADER */
header{
  padding:18px 24px;
  display:flex;
  justify-content:space-between;
  align-items:center;
}
header h1{margin:0;font-size:22px}
.btn{
  padding:10px 18px;
  border-radius:20px;
  border:none;
  cursor:pointer;
  font-weight:600;
}
.btn.green{background:var(--accent)}
.btn.red{background:var(--danger);color:#000}

/* GRID */
.grid{
  padding:24px;
  display:grid;
  grid-template-columns:repeat(auto-fit,minmax(220px,1fr));
  gap:20px;
}
.card{
  background:var(--card);
  padding:22px;
  border-radius:20px;
  box-shadow:0 12px 30px rgba(0,0,0,.4);
  transition:.35s;
  cursor:pointer;
}
.card:hover{
  transform:translateY(-8px) scale(1.02);
}
.card h3{margin-top:0}
.card p{opacity:.7}

/* MODAL */
.modal{
  position:fixed;
  inset:0;
  background:rgba(0,0,0,.6);
  display:none;
  align-items:center;
  justify-content:center;
  z-index:999;
}
.modal.active{display:flex}
.modal-box{
  background:#04251a;
  padding:24px;
  border-radius:18px;
  width:420px;
}
.modal-box h3{margin-top:0}
.modal-box label{
  display:block;
  margin:10px 0;
}
.modal-box input{margin-right:8px}

/* FOOTER */
footer{
  padding:20px;
  text-align:center;
  opacity:.6;
}
</style>
</head>

<body>

<header>
  <h1>ğŸ›¡ UKSS Admin Dashboard</h1>
  <button id="logout" class="btn green">Logout</button>
</header>

<section class="grid">
  <div class="card" onclick="go('students')">
    <h3>ğŸ‘¨â€ğŸ“ Students</h3><p>Manage registrations</p>
  </div>
  <div class="card" onclick="go('staff')">
    <h3>ğŸ‘¨â€ğŸ« Staff</h3><p>Roles & permissions</p>
  </div>
  <div class="card" onclick="go('subjects')">
    <h3>ğŸ“š Subjects</h3><p>All subjects</p>
  </div>
  <div class="card" onclick="go('classes')">
    <h3>ğŸ« Classes</h3><p>Streams & forms</p>
  </div>
  <div class="card" onclick="go('exams')">
    <h3>ğŸ“ Exams</h3><p>Exam periods</p>
  </div>
  <div class="card" onclick="go('results')">
    <h3>ğŸ“Š Results</h3><p>All results</p>
  </div>
  <div class="card" style="border:1px solid var(--danger)" onclick="openDelete()">
    <h3>âš ï¸ Delete Data</h3>
    <p>Selective & safe delete</p>
  </div>
</section>

<footer>
  Academic Year: <b id="year"></b> â€¢ UKSS System
</footer>

<!-- DELETE MODAL -->
<div class="modal" id="deleteModal">
  <div class="modal-box">
    <h3>âš ï¸ Chagua unachotaka kufuta</h3>

    <label><input type="checkbox" value="students"> Students</label>
    <label><input type="checkbox" value="subjects"> Subjects</label>
    <label><input type="checkbox" value="classes"> Classes</label>
    <label><input type="checkbox" value="exams"> Exams</label>
    <label><input type="checkbox" value="results"> Results</label>

    <p style="font-size:13px;opacity:.7">
      Andika <b>DELETE</b> kuthibitisha
    </p>
    <input id="confirmText" placeholder="Type DELETE">

    <div style="margin-top:16px;display:flex;gap:10px;justify-content:flex-end">
      <button class="btn" onclick="closeDelete()">Cancel</button>
      <button class="btn red" onclick="confirmDelete()">Delete</button>
    </div>
  </div>
</div>

<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-auth.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-firestore.js"></script>

<script src="./js/guard-admin.js"></script>

<script>
document.getElementById("year").textContent = new Date().getFullYear();
const db = firebase.firestore();

/* NAV */
function go(name){
  alert("Feature: " + name + " (utaunganisha page yake)");
}

/* LOGOUT */
document.getElementById("logout").onclick = async ()=>{
  await firebase.auth().signOut();
  location.href="index.html";
};

/* DELETE */
function openDelete(){
  document.getElementById("deleteModal").classList.add("active");
}
function closeDelete(){
  document.getElementById("deleteModal").classList.remove("active");
}

async function confirmDelete(){
  const confirmText=document.getElementById("confirmText").value;
  if(confirmText!=="DELETE"){
    alert("Andika DELETE kuthibitisha");
    return;
  }

  const checks=[...document.querySelectorAll("input[type=checkbox]:checked")];
  if(checks.length===0){
    alert("Chagua angalau kitu kimoja");
    return;
  }

  for(const c of checks){
    const snap=await db.collection(c.value).get();
    const batch=db.batch();
    snap.docs.forEach(d=>batch.delete(d.ref));
    await batch.commit();
  }

  alert("Data zimefutwa salama");
  closeDelete();
}
</script>

</body>
</html>






